<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Management - BagHub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        :root {
            --primary: #1a56db;
            --primary-dark: #1e429f;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --processing: #3b82f6;
            --shipped: #8b5cf6;
        }
        
        .order-card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .status-confirmed {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .status-processing {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--processing);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .status-shipped {
            background-color: rgba(139, 92, 246, 0.1);
            color: var(--shipped);
            border: 1px solid rgba(139, 92, 246, 0.2);
        }
        
        .status-delivered {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .status-cancelled {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        .status-returned {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6b7280;
            border: 1px solid rgba(107, 114, 128, 0.2);
        }
        
        .btn-primary {
            background-color: var(--primary);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: white;
            border: 1px solid #d1d5db;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background-color: #f9fafb;
        }
        
        .btn-danger {
            background-color: var(--error);
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
            transform: translateY(-1px);
        }
        
        .btn-success {
            background-color: var(--success);
            transition: all 0.3s ease;
        }
        
        .btn-success:hover {
            background-color: #0d9c6d;
            transform: translateY(-1px);
        }
        
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .notification {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .progress-bar {
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            background-color: #e5e7eb;
        }
        
        .progress-fill {
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .progress-confirmed {
            background-color: var(--success);
            width: 25%;
        }
        
        .progress-processing {
            background-color: var(--processing);
            width: 40%;
        }
        
        .progress-shipped {
            background-color: var(--shipped);
            width: 70%;
        }
        
        .progress-delivered {
            background-color: var(--success);
            width: 100%;
        }
        
        .individual-order {
            border-left: 4px solid #1a56db;
        }
        
        .order-group {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center">
                        <i class="fas fa-shopping-bag text-white"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-900">BagHub</h1>
                </div>
                <nav class="hidden md:flex items-center gap-6">
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Home</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Shop</a>
                    <a href="#" class="text-blue-600 font-medium">Orders</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Account</a>
                </nav>
                <div class="flex items-center gap-4">
                    <button class="p-2 text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="p-2 text-gray-600 hover:text-blue-600 transition-colors">
                        <i class="far fa-heart"></i>
                    </button>
                    <button class="p-2 text-gray-600 hover:text-blue-600 transition-colors relative">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="absolute -top-1 -right-1 bg-blue-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                    </button>
                    <div class="relative">
                        <button class="flex items-center gap-2 text-gray-700">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="hidden md:inline">John Doe</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Order Management</h1>
                    <p class="text-gray-600 mt-2">Manage and track your individual product orders</p>
                </div>
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search orders..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <select id="statusFilter" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">All Status</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="processing">Processing</option>
                        <option value="shipped">Shipped</option>
                        <option value="delivered">Delivered</option>
                        <option value="cancelled">Cancelled</option>
                        <option value="returned">Returned</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Orders Container -->
        <div id="ordersContainer" class="space-y-6">
            <!-- Orders will be dynamically loaded here -->
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="text-center py-12">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
            <p class="text-gray-600 mt-4">Loading orders...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="text-center py-12 hidden">
            <div class="w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-box-open text-gray-400 text-3xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">No orders found</h3>
            <p class="text-gray-600 mb-6">You haven't placed any orders yet.</p>
            <a href="/" class="btn-primary text-white px-6 py-3 rounded-lg inline-flex items-center gap-2">
                <i class="fas fa-shopping-bag"></i>
                Start Shopping
            </a>
        </div>
    </main>

    <!-- Cancel Order Modal -->
    <div id="cancelModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0 bg-black bg-opacity-50" onclick="closeCancelModal()"></div>
        <div class="modal-content bg-white rounded-xl w-full max-w-md relative z-10">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Cancel Order</h3>
                    <button onclick="closeCancelModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <p class="text-gray-600 mb-4">Are you sure you want to cancel <span id="cancelOrderId" class="font-semibold"></span>? This action cannot be undone.</p>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reason for cancellation (optional)</label>
                        <select id="cancelReason" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select a reason</option>
                            <option value="changed-mind">Changed my mind</option>
                            <option value="found-cheaper">Found a better price</option>
                            <option value="delivery-too-long">Delivery takes too long</option>
                            <option value="ordered-wrong-item">Ordered wrong item</option>
                            <option value="other">Other reason</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Additional comments (optional)</label>
                        <textarea id="cancelComments" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Provide more details..."></textarea>
                    </div>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="closeCancelModal()" class="btn-secondary flex-1 py-2 rounded-lg">
                        Keep Order
                    </button>
                    <button onclick="confirmCancel()" class="btn-danger text-white flex-1 py-2 rounded-lg flex items-center justify-center gap-2">
                        <i class="fas fa-times"></i>
                        <span>Cancel Order</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Return Order Modal -->
    <div id="returnModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0 bg-black bg-opacity-50" onclick="closeReturnModal()"></div>
        <div class="modal-content bg-white rounded-xl w-full max-w-md relative z-10">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Return Order</h3>
                    <button onclick="closeReturnModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <p class="text-gray-600 mb-4">Please provide details for returning <span id="returnOrderId" class="font-semibold"></span>.</p>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reason for return <span class="text-red-500">*</span></label>
                        <select id="returnReason" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select a reason</option>
                            <option value="defective-product">Product is defective/damaged</option>
                            <option value="wrong-item">Wrong item received</option>
                            <option value="size-issue">Size doesn't fit</option>
                            <option value="not-as-described">Product not as described</option>
                            <option value="changed-mind">Changed my mind</option>
                            <option value="other">Other reason</option>
                        </select>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Additional details <span class="text-red-500">*</span></label>
                        <textarea id="returnDetails" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Please provide specific details about the issue..." required></textarea>
                    </div>

                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-info-circle text-yellow-600"></i>
                            <div>
                                <p class="text-sm text-yellow-800 font-medium">Return Policy</p>
                                <p class="text-xs text-yellow-700">30-day return window • Free return shipping • Full refund upon inspection</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="closeReturnModal()" class="btn-secondary flex-1 py-2 rounded-lg">
                        Cancel Return
                    </button>
                    <button onclick="confirmReturn()" class="btn-success text-white flex-1 py-2 rounded-lg flex items-center justify-center gap-2">
                        <i class="fas fa-undo-alt"></i>
                        <span>Submit Return</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <script>
        // Dynamic Order Data
        const ordersData = {
            orders: [
                {
                    orderGroupId: "BGH-2023-001",
                    orderDate: "2023-10-15",
                    totalAmount: 5297.00,
                    items: [
                        {
                            orderId: "BGH-2023-001-1",
                            productId: "PROD-NK-270",
                            productName: "Nike Air Max 270",
                            image: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8c2hvZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60",
                            price: 2499.00,
                            quantity: 1,
                            size: "9",
                            color: "Black/White",
                            seller: "Nike Official",
                            category: "Running Shoes",
                            status: "processing",
                            estimatedDelivery: "2023-10-25"
                        },
                        {
                            orderId: "BGH-2023-001-2",
                            productId: "PROD-AD-UB",
                            productName: "Adidas Ultraboost",
                            image: "https://images.unsplash.com/photo-1525966222134-fcfa99b8ae77?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8c2hvZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60",
                            price: 1299.00,
                            quantity: 1,
                            size: "8",
                            color: "Blue/White",
                            seller: "Adidas Store",
                            category: "Running Shoes",
                            status: "shipped",
                            estimatedDelivery: "2023-10-22",
                            trackingNumber: "BD785412369",
                            carrier: "BlueDart"
                        },
                        {
                            orderId: "BGH-2023-001-3",
                            productId: "PROD-PU-RSX",
                            productName: "Puma RS-X",
                            image: "https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8c2hvZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60",
                            price: 1499.00,
                            quantity: 1,
                            size: "9",
                            color: "Red/Black",
                            seller: "Puma Official",
                            category: "Lifestyle Shoes",
                            status: "delivered",
                            deliveredDate: "2023-10-18"
                        }
                    ]
                },
                {
                    orderGroupId: "BGH-2023-002",
                    orderDate: "2023-10-10",
                    totalAmount: 2999.00,
                    items: [
                        {
                            orderId: "BGH-2023-002-1",
                            productId: "PROD-RB-CL",
                            productName: "Reebok Classic",
                            image: "https://images.unsplash.com/photo-1600185365483-26d7a4cc7519?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8c2hvZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60",
                            price: 1799.00,
                            quantity: 1,
                            size: "8",
                            color: "White/Blue",
                            seller: "Reebok Store",
                            category: "Lifestyle Shoes",
                            status: "delivered",
                            deliveredDate: "2023-10-15"
                        },
                        {
                            orderId: "BGH-2023-002-2",
                            productId: "PROD-NB-574",
                            productName: "New Balance 574",
                            image: "https://images.unsplash.com/photo-1549298916-b41d501d3772?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTR8fHNob2VzfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60",
                            price: 1200.00,
                            quantity: 1,
                            size: "9",
                            color: "Grey/Blue",
                            seller: "New Balance",
                            category: "Lifestyle Shoes",
                            status: "cancelled",
                            cancelledDate: "2023-10-12",
                            cancelReason: "Changed my mind"
                        }
                    ]
                },
                {
                    orderGroupId: "BGH-2023-003",
                    orderDate: "2023-10-05",
                    totalAmount: 3499.00,
                    items: [
                        {
                            orderId: "BGH-2023-003-1",
                            productId: "PROD-VN-OLD",
                            productName: "Vans Old Skool",
                            image: "https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fHNob2VzfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60",
                            price: 3499.00,
                            quantity: 1,
                            size: "8",
                            color: "Black/White",
                            seller: "Vans Official",
                            category: "Skate Shoes",
                            status: "returned",
                            deliveredDate: "2023-10-08",
                            returnedDate: "2023-10-12",
                            returnReason: "Size doesn't fit"
                        }
                    ]
                }
            ]
        };

        // State Management
        let currentOrderId = '';
        let filteredOrders = [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadOrders();
            setupEventListeners();
        });

        // Load and display orders
        function loadOrders() {
            filteredOrders = ordersData.orders;
            renderOrders();
            
            // Hide loading state
            document.getElementById('loadingState').classList.add('hidden');
            
            if (filteredOrders.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
            } else {
                document.getElementById('emptyState').classList.add('hidden');
            }
        }

        // Render orders to the DOM
        function renderOrders() {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = '';

            filteredOrders.forEach(orderGroup => {
                // Order Group Header
                const orderGroupHTML = `
                    <div class="order-group rounded-xl p-6 text-white mb-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between">
                            <div>
                                <h2 class="text-xl font-bold">Original Order ${orderGroup.orderGroupId}</h2>
                                <p class="text-blue-100 mt-1">
                                    Placed on ${formatDate(orderGroup.orderDate)} • ${orderGroup.items.length} Items • Total: ₹${orderGroup.totalAmount.toFixed(2)}
                                </p>
                            </div>
                            <div class="mt-4 md:mt-0">
                                <button onclick="cancelEntireOrder('${orderGroup.orderGroupId}')" 
                                        class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors">
                                    Cancel Entire Order
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += orderGroupHTML;

                // Individual Order Items
                orderGroup.items.forEach(item => {
                    const orderItemHTML = createOrderItemHTML(item);
                    container.innerHTML += orderItemHTML;
                });
            });
        }

        // Create HTML for individual order item
        function createOrderItemHTML(item) {
            const statusConfig = {
                'confirmed': { class: 'status-confirmed', text: 'Confirmed', progress: 'progress-confirmed' },
                'processing': { class: 'status-processing', text: 'Processing', progress: 'progress-processing' },
                'shipped': { class: 'status-shipped', text: 'Shipped', progress: 'progress-shipped' },
                'delivered': { class: 'status-delivered', text: 'Delivered', progress: 'progress-delivered' },
                'cancelled': { class: 'status-cancelled', text: 'Cancelled', progress: 'progress-cancelled' },
                'returned': { class: 'status-returned', text: 'Returned', progress: 'progress-delivered' }
            };

            const status = statusConfig[item.status];
            const actionsHTML = createActionsHTML(item);

            return `
                <div class="order-card bg-white rounded-xl overflow-hidden individual-order">
                    <div class="border-b border-gray-200 p-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div>
                                <div class="flex items-center gap-4">
                                    <h2 class="text-lg font-bold text-gray-900">${item.orderId}</h2>
                                    <span class="status-badge ${status.class}">${status.text}</span>
                                </div>
                                <p class="text-gray-600 mt-1">Product ID: ${item.productId} • Single Item Order</p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-gray-900">₹${item.price.toFixed(2)}</p>
                                <p class="text-gray-600 text-sm">Qty: ${item.quantity}</p>
                            </div>
                        </div>
                    </div>

                    <div class="px-6 pt-4">
                        <div class="progress-bar">
                            <div class="progress-fill ${status.progress}"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-600 mt-2">
                            <span>Order Placed</span>
                            <span>Processing</span>
                            <span>Shipped</span>
                            <span>Delivered</span>
                        </div>
                    </div>

                    <div class="p-6">
                        <div class="flex flex-col md:flex-row gap-6">
                            <div class="flex-shrink-0">
                                <img src="${item.image}" alt="${item.productName}" class="w-32 h-32 object-cover rounded-lg">
                            </div>
                            <div class="flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-3">${item.productName}</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                    <div>
                                        <p class="text-sm text-gray-600">Size</p>
                                        <p class="font-medium">${item.size}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Color</p>
                                        <p class="font-medium">${item.color}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Seller</p>
                                        <p class="font-medium">${item.seller}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Category</p>
                                        <p class="font-medium">${item.category}</p>
                                    </div>
                                </div>
                                ${createStatusInfoHTML(item)}
                            </div>
                        </div>
                    </div>

                    <div class="border-t border-gray-200 p-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-2">Order Actions</h4>
                                <p class="text-gray-600 text-sm">Manage this individual product order</p>
                            </div>
                            <div class="flex flex-wrap gap-3">
                                ${actionsHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Create status information HTML based on order status
        function createStatusInfoHTML(item) {
            switch(item.status) {
                case 'processing':
                    return `
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                                    <i class="fas fa-info"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900">Estimated Delivery: ${formatDate(item.estimatedDelivery)}</p>
                                    <p class="text-sm text-gray-600">Your item is being processed</p>
                                </div>
                            </div>
                        </div>
                    `;
                case 'shipped':
                    return `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900">Shipped via ${item.carrier}</p>
                                    <p class="text-sm text-gray-600">Tracking: ${item.trackingNumber} • Expected: ${formatDate(item.estimatedDelivery)}</p>
                                </div>
                            </div>
                        </div>
                    `;
                case 'delivered':
                    return `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900">Delivered on ${formatDate(item.deliveredDate)}</p>
                                    <p class="text-sm text-gray-600">Signed by: John Doe</p>
                                </div>
                            </div>
                        </div>
                    `;
                case 'cancelled':
                    return `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-600">
                                    <i class="fas fa-times"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900">Cancelled on ${formatDate(item.cancelledDate)}</p>
                                    <p class="text-sm text-gray-600">Reason: ${item.cancelReason}</p>
                                </div>
                            </div>
                        </div>
                    `;
                case 'returned':
                    return `
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600">
                                    <i class="fas fa-undo-alt"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900">Returned on ${formatDate(item.returnedDate)}</p>
                                    <p class="text-sm text-gray-600">Reason: ${item.returnReason}</p>
                                </div>
                            </div>
                        </div>
                    `;
                default:
                    return '';
            }
        }

        // Create action buttons based on order status
        function createActionsHTML(item) {
            const baseActions = `
                <button class="btn-primary text-white px-4 py-2 rounded-lg flex items-center gap-2" onclick="trackOrder('${item.orderId}')">
                    <i class="fas fa-truck"></i>
                    <span>Track Order</span>
                </button>
                <button class="btn-secondary px-4 py-2 rounded-lg flex items-center gap-2" onclick="downloadInvoice('${item.orderId}')">
                    <i class="fas fa-file-invoice"></i>
                    <span>Download Invoice</span>
                </button>
            `;

            switch(item.status) {
                case 'confirmed':
                case 'processing':
                case 'shipped':
                    return baseActions + `
                        <button class="btn-danger text-white px-4 py-2 rounded-lg flex items-center gap-2" onclick="openCancelModal('${item.orderId}')">
                            <i class="fas fa-times"></i>
                            <span>Cancel Order</span>
                        </button>
                    `;
                case 'delivered':
                    return baseActions + `
                        <button class="btn-success text-white px-4 py-2 rounded-lg flex items-center gap-2" onclick="openReturnModal('${item.orderId}')">
                            <i class="fas fa-undo-alt"></i>
                            <span>Return Item</span>
                        </button>
                        <button class="btn-secondary px-4 py-2 rounded-lg flex items-center gap-2" onclick="rateProduct('${item.orderId}')">
                            <i class="fas fa-star"></i>
                            <span>Rate & Review</span>
                        </button>
                    `;
                case 'cancelled':
                case 'returned':
                    return baseActions;
                default:
                    return baseActions;
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', filterOrders);
            document.getElementById('statusFilter').addEventListener('change', filterOrders);
        }

        // Filter orders based on search and status
        function filterOrders() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;

            filteredOrders = ordersData.orders.map(orderGroup => {
                const filteredItems = orderGroup.items.filter(item => {
                    const matchesSearch = item.orderId.toLowerCase().includes(searchTerm) ||
                                         item.productName.toLowerCase().includes(searchTerm) ||
                                         item.productId.toLowerCase().includes(searchTerm);
                    const matchesStatus = statusFilter === '' || item.status === statusFilter;
                    return matchesSearch && matchesStatus;
                });

                return {
                    ...orderGroup,
                    items: filteredItems
                };
            }).filter(orderGroup => orderGroup.items.length > 0);

            renderOrders();

            // Show empty state if no orders match
            if (filteredOrders.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
            } else {
                document.getElementById('emptyState').classList.add('hidden');
            }
        }

        // Modal functions
        function openCancelModal(orderId) {
            currentOrderId = orderId;
            document.getElementById('cancelOrderId').textContent = orderId;
            document.getElementById('cancelModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeCancelModal() {
            document.getElementById('cancelModal').classList.add('hidden');
            document.body.style.overflow = '';
            currentOrderId = '';
            // Reset form
            document.getElementById('cancelReason').value = '';
            document.getElementById('cancelComments').value = '';
        }

        function openReturnModal(orderId) {
            currentOrderId = orderId;
            document.getElementById('returnOrderId').textContent = orderId;
            document.getElementById('returnModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeReturnModal() {
            document.getElementById('returnModal').classList.add('hidden');
            document.body.style.overflow = '';
            currentOrderId = '';
            // Reset form
            document.getElementById('returnReason').value = '';
            document.getElementById('returnDetails').value = '';
        }

        // Action functions
        function confirmCancel() {
            const reason = document.getElementById('cancelReason').value;
            const comments = document.getElementById('cancelComments').value;

            // In a real application, you would make an API call here
            // axios.post('/api/orders/cancel', { 
            //     orderId: currentOrderId, 
            //     reason: reason,
            //     comments: comments 
            // })

            showNotification(`Order ${currentOrderId} has been cancelled successfully`, 'success');
            
            // Update local data (in real app, this would come from API response)
            updateOrderStatus(currentOrderId, 'cancelled', {
                cancelledDate: new Date().toISOString().split('T')[0],
                cancelReason: reason || 'No reason provided'
            });

            closeCancelModal();
        }

        function confirmReturn() {
            const reason = document.getElementById('returnReason').value;
            const details = document.getElementById('returnDetails').value;

            if (!reason || !details) {
                showNotification('Please provide both reason and details for return', 'error');
                return;
            }

            // In a real application, you would make an API call here
            // axios.post('/api/orders/return', { 
            //     orderId: currentOrderId, 
            //     reason: reason,
            //     details: details 
            // })

            showNotification(`Return request for ${currentOrderId} submitted successfully`, 'success');
            
            // Update local data (in real app, this would come from API response)
            updateOrderStatus(currentOrderId, 'returned', {
                returnedDate: new Date().toISOString().split('T')[0],
                returnReason: reason
            });

            closeReturnModal();
        }

        function cancelEntireOrder(orderGroupId) {
            if (confirm(`Are you sure you want to cancel the entire order ${orderGroupId}? This will cancel all items in this order.`)) {
                // In real application, cancel all items in the order group
                showNotification(`Entire order ${orderGroupId} cancellation initiated`, 'success');
            }
        }

        function trackOrder(orderId) {
            showNotification(`Tracking order ${orderId}`, 'success');
            // In real application, redirect to tracking page
        }

        function downloadInvoice(orderId) {
            showNotification(`Downloading invoice for ${orderId}`, 'success');
            // In real application, trigger PDF download
            // This would typically be: window.open(`/api/orders/${orderId}/invoice`, '_blank');
        }

        function rateProduct(orderId) {
            showNotification(`Opening rating for ${orderId}`, 'success');
            // In real application, open rating modal
        }

        // Utility functions
        function updateOrderStatus(orderId, newStatus, additionalData = {}) {
            ordersData.orders.forEach(orderGroup => {
                orderGroup.items.forEach(item => {
                    if (item.orderId === orderId) {
                        item.status = newStatus;
                        Object.assign(item, additionalData);
                    }
                });
            });
            renderOrders();
        }

        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-US', options);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `p-4 rounded-lg shadow-lg transform transition-all duration-300 notification ${
                type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <i class="fas fa-${type === 'success' ? 'check' : 'exclamation'}-circle"></i>
                    <span class="font-medium">${message}</span>
                </div>
            `;
            
            const container = document.getElementById('notificationContainer');
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (container.contains(notification)) {
                        container.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }
    </script>
</body>
</html>